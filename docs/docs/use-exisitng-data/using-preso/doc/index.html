<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=../../../../css/style.css><link rel=stylesheet type=text/css href=../../../../css/page-layouts/content-header.css><link rel=stylesheet type=text/css href=../../../../css/sidebar/style.css><link rel=stylesheet type=text/css href=../../../../css/page-layouts/style.css><link rel=stylesheet type=text/css href=../../../../css/page-layouts/syntax.css><link rel=stylesheet type=text/css href=../../../../css/tabs/style.css><link rel=stylesheet type=text/css href=../../../../css/bootstrap.min.css><link rel=stylesheet href=../../../../override/style.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lato"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source Code Pro"><link rel=stylesheet href=../../../../feather-icons/css/iconfont.css><link rel=icon href=../../../../images/favicon.png type=image/x-icon><style>:root{--white: #ffffff;--primary: #fff;--secondary: #1E1F21;--sidebar-bg: #f6f6f8;--sidebar-primary: #1E1F21;--accent: #e34a3a;--grey100: ;--grey200: #F9F9FA;--grey300: ;--grey400: ;--grey500: ;--grey600: #969DAC;--grey700: ;--grey800: ;--grey900: ;--grey-head: #EFEFF3;--nav-highlight: }</style><title>GA4GH Discovery Search API | Using Presto</title></head><body><div class=sidebar id=sidebar-nav><button id=logo-collapse-btn onclick="(function(){document.getElementById('sidebar-nav').classList.toggle('show');document.getElementById('content').classList.toggle('showing-nav')})()">
<img id=logo src=../../../../images/logo.png alt="GA4GH Discovery Search API"></button><div class="card sidebar-card"><div class=collapse-header><a class=nav-link href=../../../../docs/getting-started/><i class="icon-layers navicon"></i><h3 class="sidebar-h1 mainitem">Quick Start</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../../../docs/getting-started/introduction/><h3 class="sidebar-h2 subitem">Introduction</h3></a><a class=nav-link href=../../../../docs/getting-started/provision-data/><h3 class="sidebar-h2 subitem">Provision Data</h3></a><a class=nav-link href=../../../../docs/getting-started/consume-data/><h3 class="sidebar-h2 subitem">Consume Data</h3></a><a class=nav-link href=../../../../docs/getting-started/upload-result/><h3 class="sidebar-h2 subitem">Upload results</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../../../docs/use-exisitng-data/><i class="icon-database navicon"></i><h3 class="sidebar-h1 mainitem">Use Existing Data</h3></a></div><div class="collapse show"><div class=nav-list><a class=nav-link href=../../../../docs/use-exisitng-data/retrofit-a-data-explorer/doc/><h3 class="sidebar-h2 subitem">Retrofit data explorers</h3></a><a class=nav-link href=../../../../docs/use-exisitng-data/tables-in-a-bucket/doc/><h3 class="sidebar-h2 subitem">Tables-in-a-bucket</h3></a><a class=nav-link href=../../../../docs/use-exisitng-data/using-preso/doc/><h3 class="sidebar-h2 nav-highlight subitem" id=scrollto>Using Presto</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../../../docs/security/><i class="icon-shield navicon"></i><h3 class="sidebar-h1 mainitem">Security</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../../../docs/security/data-source/><h3 class="sidebar-h2 subitem">At the data source</h3></a><a class=nav-link href=../../../../docs/security/search-endpoint/><h3 class="sidebar-h2 subitem">At the search endpoint</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../../../docs/reference/><i class="icon-book navicon"></i><h3 class="sidebar-h1 mainitem">Implementation</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../../../docs/reference/pagination-long-queries/><h3 class="sidebar-h2 subitem">Pagination and Long Running Queries</h3></a><a class=nav-link href=../../../../docs/reference/sql-functions/><h3 class="sidebar-h2 subitem">SQL Functions</h3></a><a class=nav-link href=../../../../docs/reference/sql-grammar/><h3 class="sidebar-h2 subitem">SQL Grammar</h3></a></div></div></div></div><div class=content id=content><div class=content-header><div id=search-input-div><button class=search-button id=search-button data-toggle=modal data-target=#search-input-modal onclick=setFocusToTextBox()><h3 class=search-button-text><i class="icon-search search-icon"></i>Find anything</h3></button><div class="modal search" id=search-input-modal><div id=search-input-modal class=modal-dialog><div id=search-input-div class=modal-content><input id=search-input type=text placeholder name=search autocomplete=off>
<span class=focus-border></span><section id=search-results class=search></section></div></div></div></div><div class=content-header-nav><a class=content-header-nav-link href=../../../../api><i class=icon-code></i><span>Open API 3 Reference</span></a>
<a class=content-header-nav-link href=https://github.com/ga4gh-discovery/ga4gh-search><i class=icon-github></i><span>Doc Source</span></a>
<a class=content-header-nav-link href=https://github.com/ga4gh-discovery/><i class=icon-github></i><span>Discovery Workstream</span></a></div></div><div class=text-area><h2>Using Presto</h2><h3 id=the-dbgap-gecco-example>The dbGaP GECCO example</h3><p>In the <a href=../../../../docs/getting-started/provision-data/>provision data section</a>, we&rsquo;ve shown a quick start recipe with the <a href=https://github.com/DNAstack/ga4gh-search-adapter-presto>ga4gh-search-adapter-presto</a> docker container connected to a Presto instance hosted at <code>https://presto-public.prod.dnastack.com</code>. This section provides more information on how this was accomplished.</p><div class=example><div class="content-textbox scroll"><h5 id=quick-links>Quick Links</h5><hr><p><a href=https://github.com/DNAstack/ga4gh-search-adapter-presto>ga4gh-search-adapter-presto</a></p><p><a href=../../../../api>Open API 3 Reference</a></p><p><a href=https://github.com/ga4gh-discovery/ga4gh-search/blob/develop/SEARCHSPEC.md>Full GA4GH Search Specification</a></p><p><a href=https://github.com/ga4gh-discovery/ga4gh-search/blob/develop/TABLE.md>Table Object Specification</a></p><p><a href=https://github.com/ga4gh-discovery/ga4gh-search/blob/develop/SEARCHSPEC.md#sql-functions>Search APIâ€™s SQL dialect</a></p></div></div><h4 id=prerequisites>Prerequisites</h4><p>The following is required before we start.</p><ol><li>Java 11+</li><li>A Presto server you can access anonymously over HTTP(S).</li><li>Git</li></ol><blockquote><p>If you don&rsquo;t have a Presto server to work against and you wish to try the app, try using <code>https://presto-public.prod.dnastack.com</code> as the data source.</p></blockquote><p><strong>1. Building the Presto Adapter App</strong></p><p>Clone the repository</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>git clone https://github.com/DNAstack/ga4gh-search-adapter-presto.git
</code></pre></div><p>Build the app</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>mvn clean package
</code></pre></div><p><strong>2. Configuration</strong></p><p>For a minimal configuration, we need to provide two parameters, <code>PRESTO_DATASOURCE_URL</code> and <code>SPRING_PROFILES_ACTIVE</code>.</p><p><code>PRESTO_DATASOURCE_URL</code> points to the Presto server you wish to expose with a Search API.</p><p>Clone the repository:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=nb>export</span> <span class=nv>PRESTO_DATASOURCE_URL</span><span class=o>=</span>https://&lt;your-presto-server&gt;
<span class=nb>export</span> <span class=nv>SPRING_PROFILES_ACTIVE</span><span class=o>=</span>no-auth
</code></pre></div><p>The adapter app requires a local PostgreSQL database connection. To start the app locally with the default settings, you can spin up the database with this docker command:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>docker run -d -p 5432:5432 --name ga4ghsearchadapterpresto -e <span class=nv>POSTGRES_USER</span><span class=o>=</span>ga4ghsearchadapterpresto -e <span class=nv>POSTGRES_PASSWORD</span><span class=o>=</span>ga4ghsearchadapterpresto postgres
</code></pre></div><p><strong>3. Run the adapter app</strong></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>mvn clean spring-boot:run
</code></pre></div><p>Your application should now be accessible at <a href=http://localhost:8089/tables>http://localhost:8089/tables</a></p><p>To test the app out, follow the <a href=../../../../docs/getting-started/consume-data/>consuming data</a> section.</p><h4 id=further-configuration>Further Configuration</h4><p>Further configuration can be found at: <a href=https://github.com/DNAstack/ga4gh-search-adapter-presto>https://github.com/DNAstack/ga4gh-search-adapter-presto</a></p></div></div><script src=../../../../js/jquery-3.5.1.min.js></script><script src=../../../../js/bootstrap.min.js></script><script src=https://unpkg.com/lunr/lunr.js></script><script>document.getElementById("scrollto").scrollIntoView(true);</script><script type=text/javascript>var idx,searchInput,searchResults=null
var documents=[]
function renderSearchResults(results){if(results.length>0){if(results.length>9){results=results.slice(0,10)}
searchResults.innerHTML=''
results.forEach(result=>{var article=document.createElement('article')
var uri="/ga4gh-search-docs"+result.ref.replace("/index.json","")
article.innerHTML=`
            <a href="${uri}" class="search-result-item"><p class="search-result-title">${documents[result.ref].title}</p> <i class="icon-external-link"></i></a>
            `
searchResults.appendChild(article)})}else{searchResults.innerHTML='<p>No results found.</p>'}}
function registerSearchHandler(){searchInput.oninput=function(event){if(searchInput.value==''){searchResults.innerHTML=''}else{var query=event.target.value
var results=idx.search(query+'*')
renderSearchResults(results)}}
searchInput.focus()
searchInput.placeholder=''}
$('#search-input-modal').on('shown.bs.modal',function(){$('#search-input').trigger('focus')})
window.onload=function(){searchInput=document.getElementById('search-input')
searchResults=document.getElementById('search-results')
fetch('/ga4gh-search-docs/docs/index.json',{method:'get'}).then(res=>res.json()).then(res=>{idx=lunr(function(){this.ref('url')
this.field('title')
this.field('content')
res.forEach(function(doc){this.add(doc)
documents[doc.url]={'title':doc.title,'content':doc.content,}},this)})
registerSearchHandler()}).catch(err=>{searchResults.innerHTML=`<p>${err}</p>`})}</script></body></html>