<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=../../../css/style.css><link rel=stylesheet type=text/css href=../../../css/page-layouts/content-header.css><link rel=stylesheet type=text/css href=../../../css/sidebar/style.css><link rel=stylesheet type=text/css href=../../../css/page-layouts/style.css><link rel=stylesheet type=text/css href=../../../css/page-layouts/syntax.css><link rel=stylesheet type=text/css href=../../../css/tabs/style.css><link rel=stylesheet type=text/css href=../../../css/bootstrap.min.css><link rel=stylesheet href=../../../override/style.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lato"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source Code Pro"><link rel=stylesheet href=../../../feather-icons/css/iconfont.css><link rel=icon href=../../../images/favicon.png type=image/x-icon><style>:root{--white: #ffffff;--primary: #fff;--secondary: #1E1F21;--sidebar-bg: #f6f6f8;--sidebar-primary: #1E1F21;--accent: #e34a3a;--grey100: ;--grey200: #F9F9FA;--grey300: ;--grey400: ;--grey500: ;--grey600: #969DAC;--grey700: ;--grey800: ;--grey900: ;--grey-head: #EFEFF3;--nav-highlight: }</style><title>GA4GH Discovery Search API | SQL Functions</title></head><body><div class=sidebar id=sidebar-nav><button id=logo-collapse-btn onclick="(function(){document.getElementById('sidebar-nav').classList.toggle('show');document.getElementById('content').classList.toggle('showing-nav')})()">
<img id=logo src=../../../images/logo.png alt="GA4GH Discovery Search API"></button><div class="card sidebar-card"><div class=collapse-header><a class=nav-link href=../../../docs/getting-started/><i class="icon-layers navicon"></i><h3 class="sidebar-h1 mainitem">Quick Start</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../../docs/getting-started/introduction/><h3 class="sidebar-h2 subitem">Introduction</h3></a><a class=nav-link href=../../../docs/getting-started/provision-data/><h3 class="sidebar-h2 subitem">Provision Data</h3></a><a class=nav-link href=../../../docs/getting-started/consume-data/><h3 class="sidebar-h2 subitem">Consume Data</h3></a><a class=nav-link href=../../../docs/getting-started/upload-result/><h3 class="sidebar-h2 subitem">Upload results</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../../docs/use-exisitng-data/><i class="icon-database navicon"></i><h3 class="sidebar-h1 mainitem">Use Existing Data</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../../docs/use-exisitng-data/retrofit-a-data-explorer/doc/><h3 class="sidebar-h2 subitem">Retrofit data explorers</h3></a><a class=nav-link href=../../../docs/use-exisitng-data/tables-in-a-bucket/doc/><h3 class="sidebar-h2 subitem">Tables-in-a-bucket</h3></a><a class=nav-link href=../../../docs/use-exisitng-data/using-preso/doc/><h3 class="sidebar-h2 subitem">Using Presto</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../../docs/security/><i class="icon-shield navicon"></i><h3 class="sidebar-h1 mainitem">Security</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../../docs/security/data-source/><h3 class="sidebar-h2 subitem">At the data source</h3></a><a class=nav-link href=../../../docs/security/search-endpoint/><h3 class="sidebar-h2 subitem">At the search endpoint</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../../docs/reference/><i class="icon-book navicon"></i><h3 class="sidebar-h1 mainitem">Implementation</h3></a></div><div class="collapse show"><div class=nav-list><a class=nav-link href=../../../docs/reference/pagination-long-queries/><h3 class="sidebar-h2 subitem">Pagination and Long Running Queries</h3></a><a class=nav-link href=../../../docs/reference/sql-functions/><h3 class="sidebar-h2 nav-highlight subitem" id=scrollto>SQL Functions</h3></a><a class=nav-link href=../../../docs/reference/sql-grammar/><h3 class="sidebar-h2 subitem">SQL Grammar</h3></a></div></div></div></div><div class=content id=content><div class=content-header><div id=search-input-div><button class=search-button id=search-button data-toggle=modal data-target=#search-input-modal onclick=setFocusToTextBox()><h3 class=search-button-text><i class="icon-search search-icon"></i>Find anything</h3></button><div class="modal search" id=search-input-modal><div id=search-input-modal class=modal-dialog><div id=search-input-div class=modal-content><input id=search-input type=text placeholder name=search autocomplete=off>
<span class=focus-border></span><section id=search-results class=search></section></div></div></div></div><div class=content-header-nav><a class=content-header-nav-link href=../../../api><i class=icon-code></i><span>Open API 3 Reference</span></a>
<a class=content-header-nav-link href=https://github.com/ga4gh-discovery/ga4gh-search><i class=icon-github></i><span>Doc Source</span></a>
<a class=content-header-nav-link href=https://github.com/ga4gh-discovery/><i class=icon-github></i><span>Discovery Workstream</span></a></div></div><div class=text-area><h2>SQL Functions</h2><p>GA4GH Search API’s SQL dialect has been selected for compatibility with current major open source database platforms including Presto SQL, PostgreSQL, and MySQL, and BigQuery. There are occasional name or signature differences, but a GA4GH Search API implementation atop any of the major database platforms should be able to pass through queries that use the functions listed below with only minor tweaks.</p><p>The functions below are a subset of those available in PrestoSQL 341. In a conformant GA4GH Search API implementation, these functions must behave according to the Presto documentation. To assist with implementations directly on other database platforms, the <a href=https://docs.google.com/document/d/1y51qNuoe2ELX9kCOyQbFB4jihiKt2N8Qcd6-zzadIvk>PrestoSQL Functions Support Matrix</a> captures the differences between platforms in granular detail.</p><ul><li><strong>Logical Operators</strong><ul><li><code>AND</code>, <code>OR</code>, <code>NOT</code></li></ul></li><li><strong>Comparison Operators</strong><ul><li><code>&amp;lt;</code>, <code>></code>, <code>&amp;lt;=</code>, <code>>=</code>, <code>=</code>, <code>&amp;lt;></code>, <code>!=</code></li><li><code>BETWEEN, IS NULL, IS NOT NULL</code></li><li><code>IS DISTINCT FROM</code>*</li><li><code>IS NOT DISTINCT FROM</code>*</li><li><code>GREATEST</code>, <code>LEAST</code></li><li>Quantified Comparison Predicates: <code>ALL</code>, <code>ANY</code> and <code>SOME</code>*</li><li>Pattern Comparison: <code>LIKE</code></li></ul></li><li><strong>Conditional Expressions</strong><ul><li><code>CASE</code>, <code>IF</code>, <code>COALESCE</code>, <code>NULLIF</code></li></ul></li><li><strong>Conversion Functions</strong><ul><li><code>cast(value AS type)</code> → <code>type</code></li><li><code>format(format, args...)</code> → <code>varchar</code></li></ul></li><li><strong>Mathematical Functions</strong><ul><li>Most basic functions are supported across implementations. Notably missing are hyperbolic trig functions, infinity, floating point, and statistical/CDF functions.</li><li><code>abs(x)</code> → [same as input]</li><li><code>ceil(x)</code> → [same as input]</li><li><code>ceiling(x)</code> → [same as input]</li><li><code>degrees(x)</code> → <code>double</code>*</li><li><code>exp(x)</code> → <code>double</code></li><li><code>floor(x)</code> → [same as input]</li><li><code>ln(x)</code> → <code>double</code></li><li><code>log(b, x)</code> → <code>double</code></li><li><code>log10(x)</code> → <code>double</code></li><li><code>mod(n, m)</code> → [same as input]</li><li><code>pi()</code> → <code>double</code></li><li><code>pow(x, p)</code> → <code>double</code>*</li><li><code>power(x, p)</code> → <code>double</code></li><li><code>radians(x)</code> → <code>double</code>*</li><li><code>round(x)</code> → [same as input]</li><li><code>round(x, d)</code> → [same as input]</li><li><code>sign(x)</code> → [same as input]</li><li><code>sqrt(x)</code> → <code>double</code></li><li><code>truncate(x)</code> → <code>double</code>*</li><li>Random Functions:<ul><li><code>rand()</code> → <code>double</code>*</li><li><code>random()</code> → <code>double</code>*</li><li><code>random(n)</code> → [same as input]*</li><li><code>random(m, n)</code> → [same as input]*</li></ul></li><li>Trigonometric Functions:<ul><li><code>acos(x)</code> → <code>double</code></li><li><code>asin(x)</code> → <code>double</code></li><li><code>atan(x)</code> → <code>double</code></li><li><code>atan2(y, x)</code> → <code>double</code></li><li><code>cos(x)</code> → <code>double</code></li><li><code>sin(x)</code> → <code>double</code></li><li><code>tan(x)</code> → <code>double</code></li></ul></li></ul></li><li><strong>Bitwise Functions</strong><ul><li><code>bitwise_and(x, y)</code> → <code>bigint</code></li><li><code>bitwise_or(x, y)</code> → <code>bigint</code></li><li><code>bitwise_xor(x, y)</code> → <code>bigint</code></li><li><code>bitwise_not(x)</code> → <code>bigint</code></li><li><code>bitwise_left_shift(value, shift)</code> → [same as value]</li><li><code>bitwise_right_shift(value, shift, digits)</code> → [same as value]</li><li><code>bit_count(x, bits)</code> → <code>bigint</code>*</li></ul></li><li><strong>Regular Expression Functions</strong><ul><li><code>regexp_extract_all(string, pattern)</code> -> <code>array(varchar)</code>*</li><li><code>regexp_extract_all(string, pattern, group)</code> -> <code>array(varchar)</code>*</li><li><code>regexp_extract(string, pattern)</code> → <code>varchar</code>*</li><li><code>regexp_extract(string, pattern, group)</code> → <code>varchar</code>*</li><li><code>regexp_like(string, pattern)</code> → <code>boolean</code>*</li><li><code>regexp_replace(string, pattern)</code> → <code>varchar</code>*</li><li><code>regexp_replace(string, pattern, replacement)</code> → <code>varchar</code>*</li><li><code>regexp_replace(string, pattern, function)</code> → <code>varchar</code>*</li></ul></li><li><strong>UUID Functions</strong><ul><li><code>uuid()*</code></li></ul></li><li><strong>Session Information Functions</strong><ul><li><code>current_user</code>*</li></ul></li><li><strong>String manipulation</strong><ul><li><strong>Operators:</strong><ul><li><code>Concatenation (||)</code>*</li><li><code>LIKE</code></li></ul></li><li><strong>Functions:</strong><ul><li><code>chr(n)</code> → <code>varchar</code>*</li><li><code>codepoint(string)</code> → <code>integer</code>*</li><li><code>format(format, args...)</code> → <code>varchar</code></li><li><code>length(string)</code> → <code>bigint</code></li><li><code>lower(string)</code> → <code>varchar</code></li><li><code>lpad(string, size, padstring)</code> → <code>varchar</code></li><li><code>ltrim(string)</code> → <code>varchar</code></li><li><code>position(substring IN string)</code> → <code>bigint</code>*</li><li><code>replace(string, search, replace)</code> → <code>varchar</code></li><li><code>reverse(string)</code> → <code>varchar</code></li><li><code>rpad(string, size, padstring)</code> → <code>varchar</code></li><li><code>rtrim(string)</code> → <code>varchar</code></li><li><code>split(string, delimiter, limit)</code> -> <code>array(varchar)</code>*</li><li><code>starts_with(string, substring)</code> → <code>boolean</code>*</li><li><code>strpos(string, substring)</code> → <code>bigint</code>*</li><li><code>substr(string, start)</code> → <code>varchar</code>*</li><li><code>substring(string, start)</code> → <code>varchar</code></li><li><code>substr(string, start, length)</code> → <code>varchar</code>*</li><li><code>substring(string, start, length)</code> → <code>varchar</code></li><li><code>trim(string)</code> → <code>varchar</code></li><li><code>upper(string)</code> → <code>varchar</code></li></ul></li></ul></li><li><strong>Date manipulation</strong></li></ul><blockquote><p>Be aware of different quotation (<code>'</code>) syntax requirements between MySQL and PostgreSQL. BigQuery does not support the <code>+</code>/<code>-</code> operators for dates. Convenience methods could be replaced with <code>EXTRACT()</code>.</p></blockquote><ul><li><strong>Operators:</strong><ul><li><code>+</code>, <code>- *</code></li><li><code>AT TIME ZONE</code>*</li></ul></li><li><strong>Functions:</strong><ul><li><code>current_date</code></li><li><code>current_time</code></li><li><code>current_timestamp</code></li><li><code>current_timestamp(p)</code>*</li><li><code>date(x)</code> → <code>date</code>*</li><li><code>date_trunc(unit, x)</code> → [same as input]*</li><li><code>date_add(unit, value, timestamp)</code> → [same as input]*</li><li><code>date_diff(unit, timestamp1, timestamp2)</code> → <code>bigint</code>*</li><li><code>extract(field FROM x)</code> → <code>bigint</code>*</li><li><code>from_unixtime(unixtime)</code> -> <code>timestamp(3)</code>*</li><li><code>from_unixtime(unixtime, zone)</code> → <code>timestamp(3) with time zone</code>*</li><li><code>from_unixtime(unixtime, hours, minutes)</code> → <code>timestamp(3) with time zone</code>*</li><li><code>Localtime</code>*</li><li><code>localtimestamp</code>*</li><li><code>localtimestamp(p)</code>*</li><li><code>now()</code> → <code>timestamp(3)</code> with time zone*</li><li><code>to_unixtime(timestamp)</code> → <code>double</code>*</li></ul></li><li><strong>MySQL-like date functions:</strong><ul><li><code>date_format(timestamp, format)</code> → <code>varchar</code>*</li><li><code>date_parse(string, format)</code> → <code>timestamp(3)</code>*</li></ul></li><li><strong>Aggregate functions</strong>
**Note that Presto provides a much larger superset of functions. Bitwise, map, and approximate aggregations are mostly absent. Only BigQuery has a few native approximate aggregation functions.<ul><li><code>array_agg(x)</code> → <code>array&amp;lt;</code>[same as input]>*</li><li><code>avg(x)</code> → <code>double</code></li><li><code>bool_and(boolean)</code> → <code>boolean</code>*</li><li><code>bool_or(boolean)</code> → <code>boolean</code>*</li><li><code>count(*)</code> → <code>bigint</code>*</li><li><code>count(x)</code> → <code>bigint</code></li><li><code>count_if(x)</code> → <code>bigint</code>*</li><li><code>every(boolean)</code> → <code>boolean</code>*</li><li><code>max(x)</code> → [same as input]</li><li><code>max(x, n)</code> → <code>array&amp;lt;</code>[same as x]>*</li><li><code>min(x)</code> → [same as input]</li><li><code>min(x, n)</code> → <code>array&amp;lt;</code>[same as x]>*</li><li><code>sum(x)</code> → [same as input]</li><li><strong>Statistical Aggregate Functions:</strong><ul><li><code>corr(y, x)</code> → <code>double</code>*</li><li><code>covar_pop(y, x)</code>→ <code>double</code>*</li><li><code>covar_samp(y, x)</code> → <code>double</code>*</li><li><code>stddev(x)</code> → <code>double</code></li><li><code>stddev_pop(x)</code> → <code>double</code></li><li><code>stddev_samp(x)</code> → <code>double</code></li><li><code>variance(x)</code> → <code>double</code></li><li><code>var_pop(x)</code> → <code>double</code></li><li><code>var_samp(x)</code> → <code>double</code></li></ul></li></ul></li><li><strong>Window functions</strong><ul><li><strong>Ranking Functions:</strong><ul><li><code>cume_dist()</code> → <code>bigint</code></li><li><code>dense_rank()</code> → <code>bigint</code></li><li><code>ntile(n)</code> → <code>bigint</code></li><li><code>percent_rank()</code> → <code>double</code></li><li><code>rank()</code> → <code>bigint</code></li><li><code>row_number()</code> → <code>bigint</code></li></ul></li><li><strong>Value Functions:</strong><ul><li><code>first_value(x)</code> → [same as input]</li><li><code>last_value(x)</code> → [same as input]</li><li><code>nth_value(x, offset)</code> → [same as input]</li><li><code>lead(x[, offset[, default_value]])</code> → [same as input]</li><li><code>lag(x[, offset[, default_value]])</code> → [same as input]</li></ul></li></ul></li><li><strong>JSON functions</strong>
In general, function signatures and behaviour differs across implementations for many JSON related functions.<ul><li><code>json_array_length(json)</code> → <code>bigint</code>*</li><li><code>json_extract(json, json_path)</code> → <code>json</code>*</li><li><code>json_extract_scalar(json, json_path)</code> → varchar*</li><li><code>json_format(json)</code> → <code>varchar</code>*</li><li><code>json_size(json, json_path)</code> → <code>bigint</code>*</li></ul></li><li>Functions for working with nested and repeated data (<code>ROW</code> and <code>ARRAY</code>)
See also <code>UNNEST</code>, which is part of the SQL grammar and allows working with nested arrays as if they were rows in a joined table.</li></ul><p>Note: Arrays are mostly absent in MySQL
* Array Subscript Operator: <code>[]</code>
* Array Concatenation Operator: <code>||</code>
* <code>concat(array1, array2, ..., arrayN)</code> → <code>array</code>
* <code>cardinality(x)</code> → <code>bigint</code>*</p><ul><li><code>ga4gh_type</code> (described above)</li></ul></div></div><script src=../../../js/jquery-3.5.1.min.js></script><script src=../../../js/bootstrap.min.js></script><script src=https://unpkg.com/lunr/lunr.js></script><script>document.getElementById("scrollto").scrollIntoView(true);</script><script type=text/javascript>var idx,searchInput,searchResults=null
var documents=[]
function renderSearchResults(results){if(results.length>0){if(results.length>9){results=results.slice(0,10)}
searchResults.innerHTML=''
results.forEach(result=>{var article=document.createElement('article')
var uri="/ga4gh-search-docs"+result.ref.replace("/index.json","")
article.innerHTML=`
            <a href="${uri}" class="search-result-item"><p class="search-result-title">${documents[result.ref].title}</p> <i class="icon-external-link"></i></a>
            `
searchResults.appendChild(article)})}else{searchResults.innerHTML='<p>No results found.</p>'}}
function registerSearchHandler(){searchInput.oninput=function(event){if(searchInput.value==''){searchResults.innerHTML=''}else{var query=event.target.value
var results=idx.search(query+'*')
renderSearchResults(results)}}
searchInput.focus()
searchInput.placeholder=''}
$('#search-input-modal').on('shown.bs.modal',function(){$('#search-input').trigger('focus')})
window.onload=function(){searchInput=document.getElementById('search-input')
searchResults=document.getElementById('search-results')
fetch('/ga4gh-search-docs/docs/index.json',{method:'get'}).then(res=>res.json()).then(res=>{idx=lunr(function(){this.ref('url')
this.field('title')
this.field('content')
res.forEach(function(doc){this.add(doc)
documents[doc.url]={'title':doc.title,'content':doc.content,}},this)})
registerSearchHandler()}).catch(err=>{searchResults.innerHTML=`<p>${err}</p>`})}</script></body></html>